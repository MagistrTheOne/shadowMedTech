# API тесты через curl

## Запуск тестов

### Предварительные требования

1. Запущенный Next.js сервер:
```bash
npm run dev
```

2. Созданный тестовый пользователь (или используйте существующего)

### Запуск всех тестов

```bash
cd tests/api
chmod +x *.sh
./run-all.sh
```

### Запуск отдельных тестов

```bash
# Тесты аутентификации
./test-auth.sh

# Тесты визитов
./test-visits.sh

# Тесты LiveKit
./test-livekit.sh
```

### Использование другого URL

```bash
BASE_URL=http://localhost:3000 ./test-auth.sh
```

## Что проверяют тесты

### test-auth.sh
- ✅ Регистрация пользователя (POST /api/auth/signup)
- ✅ Вход в систему (POST /api/auth/signin)
- ✅ Получение текущего пользователя (GET /api/auth/me)
- ✅ Неавторизованный доступ
- ✅ Неверные учетные данные

### test-visits.sh
- ✅ Получение списка визитов
- ✅ Создание визита
- ✅ Получение конкретного визита
- ✅ Обновление статуса визита

### test-livekit.sh
- ✅ Получение LiveKit токена
- ✅ Dispatch агента
- ✅ Получение списка активных агентов

## Формат вывода

```
==========================================
API Authentication Tests
==========================================

1. Testing POST /api/auth/signup
✓ Signup - Status: 201

2. Testing POST /api/auth/signin
✓ Signin - Status: 200

...

==========================================
Results: 5 passed, 0 failed
==========================================
```

## Цветовая индикация

- ✅ Зеленый - тест прошел
- ❌ Красный - тест провалился
- ⚠️ Желтый - тест пропущен

